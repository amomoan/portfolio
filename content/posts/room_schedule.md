+++
title = "教室帳票変換ツール"
date = "2023-07-05"
author = ""
authorTwitter = "" #do not include @
cover = ""
tags = ["業務改善", "Python","Excel","ポートフォリオ"]
keywords = ["", ""]
description = "単票形式からマトリクス表形式に変換する。"
showFullContent = false
readingTime = false
hideComments = false
color = "" #color from the theme settings
+++
## 概要

教務システムから出力されたExcelファイル（単票形式）からマトリクス表形式のExcelファイルに変換する。教室の利用状況を総覧する帳票がなく緊急で教室変更などを行う必要が出たときに確認に時間がかかっていた。マトリクス形式に変換することですぐ状況を確認できるようになり、業務が改善した。

[github](https://github.com/amomoan/roomSchedule)でコードを公開しています。

## 効果

空いている教室の利用状況を確認するのに要していた時間の短縮

10　→　2分 /人・回

スタッフ数30人

## 詳細

dist/roomSchedule.exeを配布しています。

### コードの説明

このPythonコードは、学務システムから出力される施設予約と講義のスケジュールが記載されたファイル"施設予約.xlsx"を、時間割表のような形でExcelに書き出すためのものです。
施設予約.xlsxは非常に見づらく日々発生する教室確認作業が滞るため作成しました。

### 使い方

1. プログラムを起動します。
2. 「施設予約ファイルを選択」ウィンドウが表示されますので、対象のExcelファイル"施設予約.xlsx"を選択します。
3. 処理が完了すると、指定したExcelファイルと同じディレクトリに結果が出力されます。

### 必要なライブラリ

- os
- sys
- pandas
- datetime
- time
- numpy
- tkinter
- tqdm
- styleframe

### 処理の流れ

1. 施設予約ファイルを選択する
2. 施設予約ファイルを読み込む
3. 予約区分="施設予約"の各予約に対して時限を割り当てたデータフレームを作成
4. 予約区分="講義"のデータフレームを作成
5. 施設予約と講義のデータフレームを結合する。
6. 時間割表のような枠だけのデータフレームを作成。
7. 5のデータフレームのデータを6に転記する。
8. Excelファイルに書き込む。
